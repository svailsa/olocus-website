"use strict";(globalThis.webpackChunkolocus_docs=globalThis.webpackChunkolocus_docs||[]).push([[4792],{55:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"architecture/protocol-specification","title":"Protocol Specification","description":"The Olocus Protocol provides a minimal, extensible foundation for cryptographically-secured, timestamped data chains with universal measurement support. This specification defines the core wire format, cryptographic requirements, and chain rules that all implementations must follow.","source":"@site/docs/architecture/protocol-specification.md","sourceDirName":"architecture","slug":"/architecture/protocol-specification","permalink":"/docs/architecture/protocol-specification","draft":false,"unlisted":false,"editUrl":"https://codeberg.org/olocus/protocol/edit/main/docs/architecture/protocol-specification.md","tags":[],"version":"current","lastUpdatedAt":1764941993000,"sidebarPosition":1,"frontMatter":{"id":"protocol-specification","title":"Protocol Specification","sidebar_position":1},"sidebar":"docsSidebar","previous":{"title":"Downgrade Protection","permalink":"/docs/concepts/downgrade-protection"},"next":{"title":"Design Rationale","permalink":"/docs/architecture/design-rationale"}}');var s=n(4848),t=n(8453);const l={id:"protocol-specification",title:"Protocol Specification",sidebar_position:1},d="Olocus Protocol Specification",c={},o=[{value:"Core Data Structures",id:"core-data-structures",level:2},{value:"Block Structure",id:"block-structure",level:3},{value:"Block Header",id:"block-header",level:3},{value:"Wire Format",id:"wire-format",level:2},{value:"Binary Envelope",id:"binary-envelope",level:3},{value:"Encoding Formats",id:"encoding-formats",level:3},{value:"Compression",id:"compression",level:3},{value:"Cryptographic Operations",id:"cryptographic-operations",level:2},{value:"Signature Algorithm",id:"signature-algorithm",level:3},{value:"Hash Function",id:"hash-function",level:3},{value:"Signature Computation",id:"signature-computation",level:3},{value:"Block Hash",id:"block-hash",level:3},{value:"Chain Rules",id:"chain-rules",level:2},{value:"Genesis Block Requirements",id:"genesis-block-requirements",level:3},{value:"Sequential Block Requirements",id:"sequential-block-requirements",level:3},{value:"Validation Constants",id:"validation-constants",level:3},{value:"Universal Measurement Foundation",id:"universal-measurement-foundation",level:2},{value:"Measurement Structure",id:"measurement-structure",level:3},{value:"Core Value Types",id:"core-value-types",level:3},{value:"Fixed-Point Coordinates",id:"fixed-point-coordinates",level:3},{value:"Uncertainty Types",id:"uncertainty-types",level:3},{value:"Error Codes",id:"error-codes",level:2},{value:"Core Error Codes (0-63)",id:"core-error-codes-0-63",level:3},{value:"Error Code Allocation",id:"error-code-allocation",level:3},{value:"Version Negotiation",id:"version-negotiation",level:2},{value:"Version Format",id:"version-format",level:3},{value:"Negotiation Rules",id:"negotiation-rules",level:3},{value:"Extension Framework",id:"extension-framework",level:2},{value:"Payload Type Allocation",id:"payload-type-allocation",level:3},{value:"Standard Extension Allocations",id:"standard-extension-allocations",level:3},{value:"Algorithm Negotiation",id:"algorithm-negotiation",level:2},{value:"Crypto Suite Support",id:"crypto-suite-support",level:3},{value:"Signed Preferences",id:"signed-preferences",level:3},{value:"Security Model",id:"security-model",level:2},{value:"Threat Model Assumptions",id:"threat-model-assumptions",level:3},{value:"Protected Against",id:"protected-against",level:3},{value:"Security Properties",id:"security-properties",level:3},{value:"Implementation Requirements",id:"implementation-requirements",level:2},{value:"Mandatory Features",id:"mandatory-features",level:3},{value:"Optional Features",id:"optional-features",level:3},{value:"Test Vectors",id:"test-vectors",level:3},{value:"Formal Verification",id:"formal-verification",level:2},{value:"Verification Levels",id:"verification-levels",level:3},{value:"Verified Properties",id:"verified-properties",level:3}];function a(e){const i={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.header,{children:(0,s.jsx)(i.h1,{id:"olocus-protocol-specification",children:"Olocus Protocol Specification"})}),"\n",(0,s.jsx)(i.p,{children:"The Olocus Protocol provides a minimal, extensible foundation for cryptographically-secured, timestamped data chains with universal measurement support. This specification defines the core wire format, cryptographic requirements, and chain rules that all implementations must follow."}),"\n",(0,s.jsx)(i.h2,{id:"core-data-structures",children:"Core Data Structures"}),"\n",(0,s.jsx)(i.h3,{id:"block-structure",children:"Block Structure"}),"\n",(0,s.jsx)(i.p,{children:"Every block consists of four components:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"Block := {\n    header:     BlockHeader\n    payload:    PayloadBytes\n    signature:  bytes[64]       // Ed25519 signature\n    public_key: bytes[32]       // Ed25519 verifying key\n}\n"})}),"\n",(0,s.jsx)(i.h3,{id:"block-header",children:"Block Header"}),"\n",(0,s.jsx)(i.p,{children:"The header contains fixed metadata for every block:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"BlockHeader := {\n    version:      uint16        // Protocol version (major.minor encoded)\n    index:        uint64        // Block sequence number (0 for genesis)\n    timestamp:    int64         // Unix timestamp in seconds\n    previous:     bytes[32]     // SHA-256 hash of previous block\n    payload_hash: bytes[32]     // SHA-256 hash of payload bytes\n    payload_type: uint32        // Payload type identifier\n}\n"})}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.strong,{children:"Field Requirements:"})}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"version"}),": Must be >= 0x0105 (v1.5)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"index"}),": Must be 0 for genesis block, sequential thereafter"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"timestamp"}),": Must be monotonically increasing"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"previous"}),": Must be all zeros for genesis block"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"payload_hash"}),": Must equal SHA-256(payload_bytes)"]}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"wire-format",children:"Wire Format"}),"\n",(0,s.jsx)(i.h3,{id:"binary-envelope",children:"Binary Envelope"}),"\n",(0,s.jsx)(i.p,{children:"The canonical wire format uses a fixed-size envelope (186 bytes):"}),"\n",(0,s.jsxs)(i.table,{children:[(0,s.jsx)(i.thead,{children:(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.th,{children:"Offset"}),(0,s.jsx)(i.th,{children:"Size"}),(0,s.jsx)(i.th,{children:"Field"})]})}),(0,s.jsxs)(i.tbody,{children:[(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"0"}),(0,s.jsx)(i.td,{children:"2"}),(0,s.jsx)(i.td,{children:"version (big-endian)"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"2"}),(0,s.jsx)(i.td,{children:"8"}),(0,s.jsx)(i.td,{children:"index (big-endian)"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"10"}),(0,s.jsx)(i.td,{children:"8"}),(0,s.jsx)(i.td,{children:"timestamp (big-endian)"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"18"}),(0,s.jsx)(i.td,{children:"32"}),(0,s.jsx)(i.td,{children:"previous hash"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"50"}),(0,s.jsx)(i.td,{children:"32"}),(0,s.jsx)(i.td,{children:"payload_hash"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"82"}),(0,s.jsx)(i.td,{children:"4"}),(0,s.jsx)(i.td,{children:"payload_type (big-endian)"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"86"}),(0,s.jsx)(i.td,{children:"4"}),(0,s.jsx)(i.td,{children:"payload_size (big-endian)"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"90"}),(0,s.jsx)(i.td,{children:"32"}),(0,s.jsx)(i.td,{children:"public_key"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"122"}),(0,s.jsx)(i.td,{children:"64"}),(0,s.jsx)(i.td,{children:"signature"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"186"}),(0,s.jsx)(i.td,{children:"var"}),(0,s.jsx)(i.td,{children:"payload"})]})]})]}),"\n",(0,s.jsx)(i.h3,{id:"encoding-formats",children:"Encoding Formats"}),"\n",(0,s.jsxs)(i.table,{children:[(0,s.jsx)(i.thead,{children:(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.th,{children:"Format"}),(0,s.jsx)(i.th,{children:"Content-Type"}),(0,s.jsx)(i.th,{children:"Description"})]})}),(0,s.jsxs)(i.tbody,{children:[(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Binary"}),(0,s.jsx)(i.td,{children:(0,s.jsx)(i.code,{children:"application/x-olocus-block"})}),(0,s.jsx)(i.td,{children:"Default, SSZ-compatible"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"JSON"}),(0,s.jsx)(i.td,{children:(0,s.jsx)(i.code,{children:"application/json"})}),(0,s.jsx)(i.td,{children:"Human-readable"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"MessagePack"}),(0,s.jsx)(i.td,{children:(0,s.jsx)(i.code,{children:"application/x-msgpack"})}),(0,s.jsx)(i.td,{children:"Compact binary"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Protobuf"}),(0,s.jsx)(i.td,{children:(0,s.jsx)(i.code,{children:"application/x-protobuf"})}),(0,s.jsx)(i.td,{children:"Schema-based"})]})]})]}),"\n",(0,s.jsx)(i.h3,{id:"compression",children:"Compression"}),"\n",(0,s.jsx)(i.p,{children:"Optional compression can be specified by appending to content-type:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"+zstd"})," - Best compression ratio"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"+lz4"})," - Fastest compression"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"+gzip"})," - Most compatible"]}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:["Example: ",(0,s.jsx)(i.code,{children:"application/x-msgpack+zstd"})]}),"\n",(0,s.jsx)(i.h2,{id:"cryptographic-operations",children:"Cryptographic Operations"}),"\n",(0,s.jsx)(i.h3,{id:"signature-algorithm",children:"Signature Algorithm"}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Default"}),": Ed25519 as specified in RFC 8032"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Private key: 32 bytes"}),"\n",(0,s.jsx)(i.li,{children:"Public key: 32 bytes"}),"\n",(0,s.jsx)(i.li,{children:"Signature: 64 bytes"}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"hash-function",children:"Hash Function"}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Default"}),": SHA-256 as specified in FIPS 180-4"]}),"\n",(0,s.jsx)(i.p,{children:"Output: 32 bytes (256 bits)"}),"\n",(0,s.jsx)(i.h3,{id:"signature-computation",children:"Signature Computation"}),"\n",(0,s.jsx)(i.p,{children:"The signature covers the concatenation of:"}),"\n",(0,s.jsxs)(i.ol,{children:["\n",(0,s.jsx)(i.li,{children:"Header bytes (86 bytes, wire format)"}),"\n",(0,s.jsx)(i.li,{children:"Payload size (4 bytes, big-endian)"}),"\n",(0,s.jsx)(i.li,{children:"Payload bytes (variable)"}),"\n"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"message := header_bytes || payload_size_bytes || payload_bytes\nsignature := Ed25519_Sign(private_key, message)\n"})}),"\n",(0,s.jsx)(i.h3,{id:"block-hash",children:"Block Hash"}),"\n",(0,s.jsx)(i.p,{children:"The block hash identifies blocks and links chains:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"block_hash := SHA-256(wire_encoded_block)\n"})}),"\n",(0,s.jsx)(i.h2,{id:"chain-rules",children:"Chain Rules"}),"\n",(0,s.jsx)(i.h3,{id:"genesis-block-requirements",children:"Genesis Block Requirements"}),"\n",(0,s.jsx)(i.p,{children:"A genesis block must satisfy:"}),"\n",(0,s.jsxs)(i.ol,{children:["\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.code,{children:"index = 0"})}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"previous = [0x00; 32]"})," (32 zero bytes)"]}),"\n",(0,s.jsx)(i.li,{children:"Valid signature over header and payload"}),"\n",(0,s.jsx)(i.li,{children:"Valid payload hash"}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"sequential-block-requirements",children:"Sequential Block Requirements"}),"\n",(0,s.jsx)(i.p,{children:"For block N (where N > 0):"}),"\n",(0,s.jsxs)(i.ol,{children:["\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.code,{children:"index = previous_block.index + 1"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.code,{children:"previous = Hash(previous_block)"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.code,{children:"timestamp > previous_block.timestamp"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.code,{children:"timestamp <= current_time + MAX_FUTURE_DRIFT"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.code,{children:"timestamp >= current_time - MAX_BLOCK_AGE"})}),"\n",(0,s.jsx)(i.li,{children:"Valid signature"}),"\n",(0,s.jsx)(i.li,{children:"Valid payload hash"}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.code,{children:"payload_size <= MAX_PAYLOAD_SIZE"})}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"validation-constants",children:"Validation Constants"}),"\n",(0,s.jsxs)(i.table,{children:[(0,s.jsx)(i.thead,{children:(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.th,{children:"Constant"}),(0,s.jsx)(i.th,{children:"Value"}),(0,s.jsx)(i.th,{children:"Description"})]})}),(0,s.jsxs)(i.tbody,{children:[(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"MAX_FUTURE_DRIFT"}),(0,s.jsx)(i.td,{children:"300 seconds"}),(0,s.jsx)(i.td,{children:"Maximum timestamp ahead of current time"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"MAX_BLOCK_AGE"}),(0,s.jsx)(i.td,{children:"86400 seconds"}),(0,s.jsx)(i.td,{children:"Maximum timestamp behind current time"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"MAX_PAYLOAD_SIZE"}),(0,s.jsx)(i.td,{children:"16,777,216 bytes"}),(0,s.jsx)(i.td,{children:"Maximum payload size (16 MiB)"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"MAX_REORG_DEPTH"}),(0,s.jsx)(i.td,{children:"100 blocks"}),(0,s.jsx)(i.td,{children:"Maximum fork reorganization depth"})]})]})]}),"\n",(0,s.jsx)(i.h2,{id:"universal-measurement-foundation",children:"Universal Measurement Foundation"}),"\n",(0,s.jsx)(i.h3,{id:"measurement-structure",children:"Measurement Structure"}),"\n",(0,s.jsx)(i.p,{children:"The universal measurement structure provides consistent uncertainty and provenance tracking:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"Measurement := {\n    value:       Value           // The measured value\n    uncertainty: Uncertainty     // Quantified uncertainty\n    provenance:  Provenance      // Origin and transformation chain\n    validity:    ValidityWindow  // Temporal validity\n}\n"})}),"\n",(0,s.jsx)(i.h3,{id:"core-value-types",children:"Core Value Types"}),"\n",(0,s.jsxs)(i.p,{children:["The ",(0,s.jsx)(i.code,{children:"Value"})," enum provides structural types:"]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Primitives"}),": None, Bool, Int, UInt, Float, Decimal, String, Bytes"]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Temporal"}),": Timestamp, Duration, Date, Time, DateTime"]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Spatial"}),": Point2D, Point3D, BoundingBox, LineString, Polygon"]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Collections"}),": Array, Object, Set"]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Advanced"}),": UUID, Range, Regex, Json"]}),"\n",(0,s.jsx)(i.h3,{id:"fixed-point-coordinates",children:"Fixed-Point Coordinates"}),"\n",(0,s.jsx)(i.p,{children:"Spatial values use fixed-point representation for determinism:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Latitude/Longitude: ",(0,s.jsx)(i.code,{children:"int64"})," (degrees \xd7 10^7, ~1cm precision)"]}),"\n",(0,s.jsxs)(i.li,{children:["Altitude: ",(0,s.jsx)(i.code,{children:"int32"})," (millimeters)"]}),"\n",(0,s.jsx)(i.li,{children:"Distance: Haversine formula for geographic calculations"}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"uncertainty-types",children:"Uncertainty Types"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Gaussian"}),": Normal distribution (mean, std_dev)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Interval"}),": Range of possible values"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Circular"}),": Angular uncertainty"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Categorical"}),": Discrete possibilities with probabilities"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Confidence"}),": Simple confidence level (0.0 to 1.0)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Exact"}),": No uncertainty"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Unknown"}),": Uncertainty not quantified"]}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"error-codes",children:"Error Codes"}),"\n",(0,s.jsx)(i.h3,{id:"core-error-codes-0-63",children:"Core Error Codes (0-63)"}),"\n",(0,s.jsxs)(i.table,{children:[(0,s.jsx)(i.thead,{children:(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.th,{children:"Code"}),(0,s.jsx)(i.th,{children:"Name"}),(0,s.jsx)(i.th,{children:"Description"})]})}),(0,s.jsxs)(i.tbody,{children:[(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"0"}),(0,s.jsx)(i.td,{children:"Ok"}),(0,s.jsx)(i.td,{children:"Success"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"1"}),(0,s.jsx)(i.td,{children:"VersionMismatch"}),(0,s.jsx)(i.td,{children:"Incompatible protocol version"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"2"}),(0,s.jsx)(i.td,{children:"BrokenChain"}),(0,s.jsx)(i.td,{children:"Previous hash mismatch"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"3"}),(0,s.jsx)(i.td,{children:"InvalidIndex"}),(0,s.jsx)(i.td,{children:"Non-sequential block index"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"4"}),(0,s.jsx)(i.td,{children:"TimestampRegression"}),(0,s.jsx)(i.td,{children:"Timestamp before previous block"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"5"}),(0,s.jsx)(i.td,{children:"PayloadMismatch"}),(0,s.jsx)(i.td,{children:"Payload hash incorrect"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"6"}),(0,s.jsx)(i.td,{children:"InvalidSignature"}),(0,s.jsx)(i.td,{children:"Signature verification failed"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"7"}),(0,s.jsx)(i.td,{children:"MalformedBlock"}),(0,s.jsx)(i.td,{children:"Cannot parse block"})]})]})]}),"\n",(0,s.jsx)(i.h3,{id:"error-code-allocation",children:"Error Code Allocation"}),"\n",(0,s.jsxs)(i.table,{children:[(0,s.jsx)(i.thead,{children:(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.th,{children:"Range"}),(0,s.jsx)(i.th,{children:"Purpose"})]})}),(0,s.jsxs)(i.tbody,{children:[(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"0-63"}),(0,s.jsx)(i.td,{children:"Core protocol errors"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"64-127"}),(0,s.jsx)(i.td,{children:"Reserved for future core"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"128-255"}),(0,s.jsx)(i.td,{children:"Standard extension errors"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"256+"}),(0,s.jsx)(i.td,{children:"Extension-specific errors"})]})]})]}),"\n",(0,s.jsx)(i.h2,{id:"version-negotiation",children:"Version Negotiation"}),"\n",(0,s.jsx)(i.h3,{id:"version-format",children:"Version Format"}),"\n",(0,s.jsx)(i.p,{children:"Protocol version encoded as 16-bit integer:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"High byte: Major version"}),"\n",(0,s.jsx)(i.li,{children:"Low byte: Minor version"}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:["Example: ",(0,s.jsx)(i.code,{children:"0x0107"})," = version 1.7"]}),"\n",(0,s.jsx)(i.h3,{id:"negotiation-rules",children:"Negotiation Rules"}),"\n",(0,s.jsxs)(i.ol,{children:["\n",(0,s.jsx)(i.li,{children:"Peers must offer their highest supported version"}),"\n",(0,s.jsx)(i.li,{children:"Connection uses highest mutually supported version"}),"\n",(0,s.jsx)(i.li,{children:"If no common version exists, connection fails"}),"\n",(0,s.jsx)(i.li,{children:"Implementations must not accept versions below minimum"}),"\n",(0,s.jsx)(i.li,{children:"Version offers must be cryptographically signed"}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"extension-framework",children:"Extension Framework"}),"\n",(0,s.jsx)(i.h3,{id:"payload-type-allocation",children:"Payload Type Allocation"}),"\n",(0,s.jsxs)(i.table,{children:[(0,s.jsx)(i.thead,{children:(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.th,{children:"Range"}),(0,s.jsx)(i.th,{children:"Purpose"}),(0,s.jsx)(i.th,{children:"Registration"})]})}),(0,s.jsxs)(i.tbody,{children:[(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"0x0000-0x00FF"}),(0,s.jsx)(i.td,{children:"Core protocol"}),(0,s.jsx)(i.td,{children:"Reserved"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"0x0100-0x7FFF"}),(0,s.jsx)(i.td,{children:"Standard extensions"}),(0,s.jsx)(i.td,{children:"Maintainer-allocated"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"0x8000-0xFFFF"}),(0,s.jsx)(i.td,{children:"User-defined"}),(0,s.jsx)(i.td,{children:"No registration required"})]})]})]}),"\n",(0,s.jsx)(i.h3,{id:"standard-extension-allocations",children:"Standard Extension Allocations"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"0x0100"}),": olocus-location (GPS tracking, visit detection)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"0x0200-0x02FF"}),": olocus-trust (Trust, peer connections, reputation)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"0x0300-0x03FF"}),": olocus-tsa (RFC 3161 timestamps, anchoring)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"0x0400-0x04FF"}),": olocus-http (HTTP/REST transport)"]}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"algorithm-negotiation",children:"Algorithm Negotiation"}),"\n",(0,s.jsx)(i.h3,{id:"crypto-suite-support",children:"Crypto Suite Support"}),"\n",(0,s.jsxs)(i.table,{children:[(0,s.jsx)(i.thead,{children:(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.th,{children:"Suite ID"}),(0,s.jsx)(i.th,{children:"Signature"}),(0,s.jsx)(i.th,{children:"Hash"}),(0,s.jsx)(i.th,{children:"Status"})]})}),(0,s.jsxs)(i.tbody,{children:[(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"0x00"}),(0,s.jsx)(i.td,{children:"Ed25519"}),(0,s.jsx)(i.td,{children:"SHA-256"}),(0,s.jsx)(i.td,{children:"Required"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"0x01"}),(0,s.jsx)(i.td,{children:"Dilithium3"}),(0,s.jsx)(i.td,{children:"SHA3-256"}),(0,s.jsx)(i.td,{children:"Optional (Post-quantum)"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"0x02"}),(0,s.jsx)(i.td,{children:"Hybrid"}),(0,s.jsx)(i.td,{children:"SHA-256"}),(0,s.jsx)(i.td,{children:"Optional (Migration)"})]})]})]}),"\n",(0,s.jsx)(i.h3,{id:"signed-preferences",children:"Signed Preferences"}),"\n",(0,s.jsx)(i.p,{children:"All algorithm preferences must be cryptographically signed:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"SignedAlgorithmPreferences := {\n    preferences:  AlgorithmPreferences\n    signature:    bytes[64]       // Ed25519 signature\n    signer_key:   bytes[32]       // Public key\n    timestamp:    int64           // Freshness check\n    nonce:        bytes[32]       // Replay prevention\n}\n"})}),"\n",(0,s.jsx)(i.p,{children:"This ensures:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Authentication"}),": Preferences signed by peer's key"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Integrity"}),": Modification invalidates signature"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Freshness"}),": Timestamp prevents old preferences"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Non-replay"}),": Nonce prevents replay attacks"]}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"security-model",children:"Security Model"}),"\n",(0,s.jsx)(i.h3,{id:"threat-model-assumptions",children:"Threat Model Assumptions"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Adversary controls network communication"}),"\n",(0,s.jsx)(i.li,{children:"Adversary may participate in protocol"}),"\n",(0,s.jsx)(i.li,{children:"Private keys remain secure (HSM recommended)"}),"\n",(0,s.jsx)(i.li,{children:"Approximate time synchronization (\xb15 minutes)"}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"protected-against",children:"Protected Against"}),"\n",(0,s.jsxs)(i.table,{children:[(0,s.jsx)(i.thead,{children:(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.th,{children:"Threat"}),(0,s.jsx)(i.th,{children:"Protection"})]})}),(0,s.jsxs)(i.tbody,{children:[(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Block forgery"}),(0,s.jsx)(i.td,{children:"Ed25519 signatures"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Chain tampering"}),(0,s.jsx)(i.td,{children:"Hash linking"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Replay attacks"}),(0,s.jsx)(i.td,{children:"Index + timestamp + nonce"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Algorithm downgrade"}),(0,s.jsx)(i.td,{children:"Multi-layer protection"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Man-in-the-middle"}),(0,s.jsx)(i.td,{children:"Signed preferences"})]})]})]}),"\n",(0,s.jsx)(i.h3,{id:"security-properties",children:"Security Properties"}),"\n",(0,s.jsx)(i.p,{children:"The protocol guarantees:"}),"\n",(0,s.jsxs)(i.ol,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Chain Integrity"}),": Hash continuity prevents tampering"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Signature Validity"}),": All blocks cryptographically verified"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Temporal Ordering"}),": Monotonic timestamps"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Payload Integrity"}),": Hash verification"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Non-repudiation"}),": Signature binding to public key"]}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"implementation-requirements",children:"Implementation Requirements"}),"\n",(0,s.jsx)(i.h3,{id:"mandatory-features",children:"Mandatory Features"}),"\n",(0,s.jsx)(i.p,{children:"All conforming implementations must support:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Ed25519 signatures"}),"\n",(0,s.jsx)(i.li,{children:"SHA-256 hashing"}),"\n",(0,s.jsx)(i.li,{children:"Binary wire format"}),"\n",(0,s.jsx)(i.li,{children:"Genesis block creation"}),"\n",(0,s.jsx)(i.li,{children:"Sequential block validation"}),"\n",(0,s.jsx)(i.li,{children:"Basic error handling"}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"optional-features",children:"Optional Features"}),"\n",(0,s.jsx)(i.p,{children:"Implementations may optionally support:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Alternative encoding formats"}),"\n",(0,s.jsx)(i.li,{children:"Compression methods"}),"\n",(0,s.jsx)(i.li,{children:"Post-quantum cryptography"}),"\n",(0,s.jsx)(i.li,{children:"Extension-specific payloads"}),"\n",(0,s.jsx)(i.li,{children:"Network protocols"}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"test-vectors",children:"Test Vectors"}),"\n",(0,s.jsx)(i.p,{children:"Implementations should validate against provided test vectors to ensure compatibility and correctness. See the reference implementation for canonical test cases."}),"\n",(0,s.jsx)(i.h2,{id:"formal-verification",children:"Formal Verification"}),"\n",(0,s.jsx)(i.h3,{id:"verification-levels",children:"Verification Levels"}),"\n",(0,s.jsxs)(i.table,{children:[(0,s.jsx)(i.thead,{children:(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.th,{children:"Level"}),(0,s.jsx)(i.th,{children:"Scope"}),(0,s.jsx)(i.th,{children:"Method"})]})}),(0,s.jsxs)(i.tbody,{children:[(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"FV-L1"}),(0,s.jsx)(i.td,{children:"Protocol Logic"}),(0,s.jsx)(i.td,{children:"Symbolic Model (Tamarin)"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"FV-L2"}),(0,s.jsx)(i.td,{children:"Core Implementation"}),(0,s.jsx)(i.td,{children:"Type Verification (F*/hax)"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"FV-L3"}),(0,s.jsx)(i.td,{children:"Full Implementation"}),(0,s.jsx)(i.td,{children:"Computational Model"})]})]})]}),"\n",(0,s.jsx)(i.h3,{id:"verified-properties",children:"Verified Properties"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Chain integrity and hash continuity"}),"\n",(0,s.jsx)(i.li,{children:"Signature validity and binding"}),"\n",(0,s.jsx)(i.li,{children:"Index monotonicity"}),"\n",(0,s.jsx)(i.li,{children:"Timestamp ordering"}),"\n",(0,s.jsx)(i.li,{children:"Downgrade resistance"}),"\n",(0,s.jsx)(i.li,{children:"Preference authenticity"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"High-security deployments should achieve FV-L2 verification for mission-critical applications."})]})}function h(e={}){const{wrapper:i}={...(0,t.R)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},8453:(e,i,n)=>{n.d(i,{R:()=>l,x:()=>d});var r=n(6540);const s={},t=r.createContext(s);function l(e){const i=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function d(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),r.createElement(t.Provider,{value:i},e.children)}}}]);